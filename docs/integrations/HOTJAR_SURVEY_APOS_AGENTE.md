# üéØ Survey Ap√≥s Cria√ß√£o de Agente - Guia Completo

**Data:** 13/10/2025  
**Objetivo:** Mostrar survey apenas ap√≥s usu√°rio criar um agente

---

## üìã M√©todo 1: Por URL (Mais Simples)

### **Como Funciona:**

Survey aparece quando usu√°rio est√° na p√°gina de sucesso ap√≥s criar agente.

### **Configura√ß√£o no Hotjar:**

1. **Criar Survey:**
   - V√° em **Surveys** ‚Üí **Create survey**
   - Nome: "Feedback P√≥s-Cria√ß√£o de Agente"

2. **Perguntas Recomendadas:**

   ```yaml
   Pergunta 1: "Qu√£o f√°cil foi criar seu agente?"
   Tipo: Rating (1-10)
   
   Pergunta 2: "Isso vai economizar seu tempo?"
   Tipo: Multiple choice
   Op√ß√µes:
     - Sim, muito! (mais de 5 horas/semana)
     - Sim, um pouco (1-5 horas/semana)
     - N√£o tenho certeza ainda
     - N√£o
   
   Pergunta 3: "O que podemos melhorar?"
   Tipo: Open text (opcional)
   ```

3. **Targeting:**

   ```yaml
   Device: All devices
   Users: All users
   
   Page targeting:
     ‚úÖ Show on specific pages
     URL contains: /builder
     ou
     URL contains: /agents
   ```

4. **Behavior:**

   ```yaml
   Timing:
     ‚óè After a delay on the page
     Display after: 5 seconds
   
   Frequency:
     ‚óè Only once, even if they do not respond
   ```

**Pr√≥s:**

- ‚úÖ Muito simples de configurar
- ‚úÖ N√£o precisa mexer no c√≥digo

**Contras:**

- ‚ö†Ô∏è Pode aparecer mesmo se usu√°rio n√£o criou agente
- ‚ö†Ô∏è Menos preciso

---

## üìã M√©todo 2: Por Evento Customizado (RECOMENDADO)

### **Como Funciona:**

Seu c√≥digo envia um evento `agent_created` para o Hotjar quando o agente √© criado.

### **Passo 1: Adicionar C√≥digo no Builder**

No arquivo onde o agente √© salvo, adicione:

```typescript
// src/components/agent-builder/agent-builder.tsx
import { useHotjar } from '@/hooks/use-hotjar';

export function AgentBuilder() {
  const { trackEvent } = useHotjar();

  const handleSaveAgent = async (nodes?: AgentNode[], edges?: AgentEdge[]) => {
    // ... c√≥digo existente de salvar agente ...
    
    try {
      // Salvar agente
      const response = await fetch('/api/agents/save', {
        method: 'POST',
        body: JSON.stringify(updatedAgent),
      });

      if (response.ok) {
        // ‚úÖ ADICIONAR ESTA LINHA:
        trackEvent('agent_created');
        
        // Mostrar mensagem de sucesso
        toast.success('Agente salvo com sucesso!');
      }
    } catch (error) {
      console.error('Erro ao salvar:', error);
    }
  };

  return (
    // Seu componente
  );
}
```

### **Passo 2: Configurar Survey no Hotjar**

1. **Criar Survey** (mesmo do M√©todo 1)

2. **Targeting - DIFERENTE:**

   ```yaml
   Device: All devices
   Users: All users
   
   Page targeting:
     ‚úÖ Show on all pages
   
   Event targeting: ‚≠ê (IMPORTANTE!)
     ‚úÖ Trigger when event occurs
     Event name: agent_created
   ```

3. **Behavior:**

   ```yaml
   Timing:
     ‚óè Immediately after event
     (ou)
     ‚óè After a delay
     Display after: 3 seconds
   
   Frequency:
     ‚óè Only once, even if they do not respond
   ```

**Pr√≥s:**

- ‚úÖ Muito preciso (s√≥ aparece quando agente √© criado)
- ‚úÖ Funciona em qualquer p√°gina
- ‚úÖ Pode rastrear outros eventos tamb√©m

**Contras:**

- ‚ö†Ô∏è Precisa adicionar c√≥digo
- ‚ö†Ô∏è Precisa testar se evento est√° sendo enviado

---

## üìã M√©todo 3: Por Evento + Delay (MAIS SOFISTICADO)

### **Como Funciona:**

Survey aparece apenas ap√≥s usu√°rio criar E executar o agente (mais engajamento).

### **C√≥digo:**

```typescript
// src/components/agent-builder/agent-builder.tsx
import { useHotjar } from '@/hooks/use-hotjar';
import { useState } from 'react';

export function AgentBuilder() {
  const { trackEvent, showSurvey } = useHotjar();
  const [agentCreated, setAgentCreated] = useState(false);

  const handleSaveAgent = async () => {
    // Salvar agente...
    
    if (response.ok) {
      trackEvent('agent_created');
      setAgentCreated(true);
    }
  };

  const handleExecuteAgent = async () => {
    // Executar agente...
    
    if (response.ok && agentCreated) {
      // Usu√°rio criou E executou o agente
      trackEvent('agent_executed_first_time');
      
      // Aguardar 3 segundos e mostrar survey
      setTimeout(() => {
        showSurvey('seu-survey-id'); // ID do Hotjar
      }, 3000);
    }
  };

  return (
    // Seu componente
  );
}
```

### **Configura√ß√£o no Hotjar:**

```yaml
Event targeting:
  ‚úÖ Trigger when event occurs
  Event name: agent_executed_first_time

Behavior:
  Timing: Immediately after event
  Frequency: Only once per user (mais restritivo)
```

**Quando usar:**

- ‚úÖ Quer garantir que usu√°rio teve sucesso completo
- ‚úÖ Quer feedback sobre a experi√™ncia completa (criar + executar)

---

## üéØ Qual M√©todo Escolher?

### **Use M√©todo 1 (URL) se:**

- ‚úÖ Quer algo r√°pido (5 minutos)
- ‚úÖ N√£o quer mexer no c√≥digo
- ‚úÖ Aceita um pouco de imprecis√£o

### **Use M√©todo 2 (Evento) se:** ‚≠ê RECOMENDADO

- ‚úÖ Quer precis√£o total
- ‚úÖ Pode adicionar 1 linha de c√≥digo
- ‚úÖ Quer rastrear outros eventos tamb√©m

### **Use M√©todo 3 (Evento + Delay) se:**

- ‚úÖ Quer feedback ap√≥s experi√™ncia completa
- ‚úÖ Tem controle total do c√≥digo
- ‚úÖ Quer otimizar taxa de resposta

---

## üß™ Como Testar

### **Teste 1: Verificar se Evento Est√° Sendo Enviado**

1. Abra seu site
2. Abra DevTools (F12)
3. V√° na aba **Console**
4. Digite:

   ```javascript
   window.hj = window.hj || function() { console.log('Hotjar event:', arguments); };
   ```

5. Crie um agente
6. Voc√™ deve ver no console:

   ```
   Hotjar event: ['event', 'agent_created']
   ```

### **Teste 2: Verificar se Survey Aparece**

1. Abra site em **aba an√¥nima**
2. Crie um agente
3. Aguarde 3-5 segundos
4. Survey deve aparecer

**Se n√£o aparecer:**

- Verifique se evento est√° sendo enviado (Teste 1)
- Verifique configura√ß√£o de targeting no Hotjar
- Verifique se frequency n√£o est√° bloqueando (voc√™ j√° respondeu antes?)

---

## üìä Exemplo Completo de Implementa√ß√£o

### **Arquivo: `src/components/agent-builder/agent-builder.tsx`**

```typescript
'use client';

import { useHotjar } from '@/hooks/use-hotjar';
import { useState, useEffect } from 'react';

export function AgentBuilder() {
  const { trackEvent, identifyUser } = useHotjar();
  const [agentStats, setAgentStats] = useState({
    created: 0,
    executed: 0,
  });

  // Identificar usu√°rio ao carregar
  useEffect(() => {
    const user = getCurrentUser(); // Sua fun√ß√£o de pegar usu√°rio
    if (user) {
      identifyUser(user.id, {
        email: user.email,
        plan: user.plan,
        company: user.company,
      });
    }
  }, [identifyUser]);

  const handleSaveAgent = async (nodes?: AgentNode[], edges?: AgentEdge[]) => {
    try {
      const response = await fetch('/api/agents/save', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(updatedAgent),
      });

      if (response.ok) {
        // Rastrear cria√ß√£o
        trackEvent('agent_created');
        
        // Atualizar stats
        setAgentStats(prev => ({
          ...prev,
          created: prev.created + 1,
        }));

        // Se √© o primeiro agente, rastrear milestone
        if (agentStats.created === 0) {
          trackEvent('first_agent_created');
        }

        toast.success('Agente criado com sucesso! üéâ');
      }
    } catch (error) {
      trackEvent('agent_creation_error');
      console.error('Erro:', error);
    }
  };

  const handleExecuteAgent = async () => {
    try {
      const response = await executeAgent(agent);

      if (response.ok) {
        // Rastrear execu√ß√£o
        trackEvent('agent_executed');
        
        // Atualizar stats
        setAgentStats(prev => ({
          ...prev,
          executed: prev.executed + 1,
        }));

        // Se √© a primeira execu√ß√£o ap√≥s criar, rastrear
        if (agentStats.executed === 0 && agentStats.created > 0) {
          trackEvent('first_agent_execution_success');
        }

        toast.success('Agente executado com sucesso!');
      }
    } catch (error) {
      trackEvent('agent_execution_error');
      console.error('Erro:', error);
    }
  };

  return (
    <div>
      {/* Seu componente */}
    </div>
  );
}
```

---

## üìã Eventos Recomendados para Rastrear

```typescript
// Eventos de Cria√ß√£o
trackEvent('agent_created');              // Qualquer agente criado
trackEvent('first_agent_created');        // Primeiro agente do usu√°rio
trackEvent('agent_created_from_template'); // Criado de template
trackEvent('agent_created_from_scratch'); // Criado do zero

// Eventos de Execu√ß√£o
trackEvent('agent_executed');             // Qualquer execu√ß√£o
trackEvent('first_agent_execution');      // Primeira execu√ß√£o
trackEvent('agent_execution_success');    // Execu√ß√£o com sucesso
trackEvent('agent_execution_error');      // Execu√ß√£o com erro

// Eventos de Engajamento
trackEvent('agent_edited');               // Editou agente existente
trackEvent('agent_deleted');              // Deletou agente
trackEvent('agent_shared');               // Compartilhou agente
trackEvent('template_viewed');            // Visualizou template

// Milestones
trackEvent('5_agents_created');           // Criou 5 agentes
trackEvent('10_executions');              // 10 execu√ß√µes
trackEvent('power_user');                 // Usu√°rio avan√ßado
```

---

## ‚úÖ Checklist de Implementa√ß√£o

### **C√≥digo:**

- [ ] Hook `useHotjar` importado
- [ ] `trackEvent('agent_created')` adicionado ap√≥s salvar
- [ ] Testado no console (evento sendo enviado)

### **Hotjar:**

- [ ] Survey criado com perguntas relevantes
- [ ] Targeting configurado com evento `agent_created`
- [ ] Behavior configurado (timing + frequency)
- [ ] Survey ativado (n√£o est√° em draft)

### **Teste:**

- [ ] Testado em aba an√¥nima
- [ ] Survey aparece ap√≥s criar agente
- [ ] Survey N√ÉO aparece ao mudar de p√°gina
- [ ] Survey N√ÉO aparece segunda vez (frequency)

---

## üéØ Perguntas Recomendadas para o Survey

### **Vers√£o Curta (2 perguntas):**

```yaml
1. "Qu√£o f√°cil foi criar seu agente?"
   1 (Muito dif√≠cil) ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 10 (Muito f√°cil)

2. "Isso vai economizar seu tempo?"
   ‚óã Sim, muito!
   ‚óã Sim, um pouco
   ‚óã N√£o tenho certeza
   ‚óã N√£o
```

### **Vers√£o Completa (4 perguntas):**

```yaml
1. "Qu√£o f√°cil foi criar seu agente?"
   Rating 1-10

2. "Quanto tempo voc√™ acha que vai economizar?"
   ‚óã Mais de 10 horas/semana
   ‚óã 5-10 horas/semana
   ‚óã 1-5 horas/semana
   ‚óã Menos de 1 hora/semana
   ‚óã N√£o vai economizar

3. "Voc√™ recomendaria o SimplifiqueIA para outros profissionais de RH?"
   Rating 0-10 (NPS)

4. "O que quase te fez desistir?"
   [Texto livre - opcional]
```

---

## üìä An√°lise dos Resultados

### **M√©tricas para Acompanhar:**

```yaml
Taxa de Resposta:
  Meta: > 30%
  Como calcular: Respostas / Agentes criados

Facilidade (Pergunta 1):
  Meta: M√©dia > 7/10
  A√ß√£o se < 7: Melhorar onboarding

Economia de Tempo (Pergunta 2):
  Meta: > 70% dizem "Sim"
  A√ß√£o se < 70%: Revisar proposta de valor

NPS (Pergunta 3):
  Meta: > 50
  Como calcular: % Promotores - % Detratores
```

---

## üöÄ Pr√≥ximos Passos

1. **Implementar M√©todo 2** (evento customizado)
2. **Testar em desenvolvimento**
3. **Ativar em produ√ß√£o**
4. **Analisar primeiros 20 resultados**
5. **Iterar baseado em feedback**

---

**Survey configurado! Agora voc√™ vai saber exatamente o que os usu√°rios acham ap√≥s criar o primeiro agente.** üéâ
